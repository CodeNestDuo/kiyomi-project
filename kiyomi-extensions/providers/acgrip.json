{
  "name": "acgrip",
  "displayName": "ACG.RIP (Chinese Anime)",
  "siteUrl": "https://acg.rip",
  "iconUrl": "https://acg.rip/favicon.ico",
  "type": "RSS_XML",
  "isAdult": false,
  "isSecure": true,
  "isPrivate": false,

  // ACG.RIP does not use categories in the URL, so the map is simple.
  "categoryMap": {
    "All": "",
    "Anime": ""
  },

  // Full, absolute URL is required for the DynamicProviderEngine
  "searchUrlTemplate": "https://acg.rip/.xml?term={query}",

  "searchSteps": [
    {
      "stepType": "HTTP_REQUEST",
      "method": "GET",
      "urlKey": "searchUrlTemplate"
    },
    {
      "stepType": "MAP_RESULTS_GENERIC",
      "rootSelector": "item",
      "isRootArray": false,

      "fields": {
        "title": {
          "accessor": "title::text",
          "accessorType": "XML_TAG"
        },
        "infoUrl": { // The GUID is the permanent link to the detail page
          "accessor": "guid::text",
          "accessorType": "XML_TAG"
        },
        // CRITICAL FIX: Use the full Jsoup selector syntax for the attribute
        "torrentDownloadUrl": {
          "accessor": "enclosure[url]::attr(url)", // Select <enclosure> that has a 'url' attribute, THEN get the attribute
          "accessorType": "XML_TAG"
        }
        // NOTE: Size, seeds, and peers are missing from this RSS feed.
      },

      "postProcessors": [
        // Since the feed lacks InfoHash/Magnet, we will build a Magnet from the URL
        // Your application must implement the BUILD_MAGNET_FROM_URL logic to resolve the InfoHash
        {
          "processorType": "FUNCTION_CALL",
          "functionName": "BUILD_MAGNET_FROM_URL",
          "sourceKey": "torrentDownloadUrl",
          "targetKey": "magnetUrl",
          "extraSourceKey": "title"
        }
      ],

      "finalMapping": {
        "title": "{title}",
        "torrentDownloadUrl": "{torrentDownloadUrl}",
        "magnetUrl": "{magnetUrl}", // Will be populated by the post-processor
        "infoUrl": "{infoUrl}"
      }
    }
  ]
}